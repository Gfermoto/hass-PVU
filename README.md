# hass-PVU
## Система автоматизации приточно-вытяжной вентиляции (ПВУ)

### Описание
Данный проект представляет собой готовое решение для автоматизации приточно-вытяжной вентиляции на базе Home Assistant с использованием оборудования Turkov. Система обеспечивает комфортный микроклимат в помещении, оптимизируя энергопотребление и качество воздуха.

### Компоненты системы
1. **Контроллер**: Home Assistant
   - Версия: 2023.12.0 или новее
   - Рекомендуется установка на выделенное устройство

2. **Вентиляционная установка**: 
   - Производитель: Turkov
   - Модель: с рекуперацией тепла и влаги (3 ступени рекуперации)
   - Рабочий диапазон температур: до -35°C
   - Особенности: встроенный ModBus RTU интерфейс

3. **Интеграция**: [hass-turkov](https://github.com/alryaz/hass-turkov)
   - Поддержка всех функций установки через ModBus RTU
   - Автоматическое обнаружение устройства
   - Расширенная диагностика и мониторинг

4. **Датчик качества воздуха**: [AirGradient](https://www.airgradient.com/)
   - Измеряемые параметры:
     * CO₂ (0-40000 ppm)
     * Температура (-10 до +60°C)
     * Относительная влажность (0-100%)
     * PM2.5 (опционально)
   - Возможности:
     * WiFi подключение
     * MQTT интеграция
     * Открытый исходный код
     * DIY сборка или готовое решение

### Функциональные возможности

#### 1. Автоматическое управление режимами работы
- **Режим обогрева**:
  * Активируется при температуре наружного воздуха ниже заданной (+5°C на улице и в помещении не более +25°C)
  * Если температура воздуха в помещении выше +25°C, отопление временно отключается до достижения +23°C
  * Использует рекуперацию тепла
  * Защита от обмерзания теплообменника
  
- **Режим вентиляции**:
  * Основной режим работы
  * Адаптивная скорость вентиляторов
  * Байпас рекуператора при благоприятных условиях
  
- **Режим охлаждения**:
  * Активируется при температуре в помещении выше +25°C
  * Работает только при температуре наружного воздуха выше +18°C
  * При более низкой температуре наружного воздуха переключается в режим вентиляции и рекомендует естественное проветривание
  * Использование естественного охлаждения
  * Защита от конденсации

#### 2. Управление на основе качества воздуха
- **Мониторинг CO₂**:
  * Пороговые значения:
    - Нормальный уровень: до 600 ppm (ночь), до 800 ppm (день)
    - Предупреждение: 800-1200 ppm
    - Интенсивная вентиляция: более 1200 ppm
  
- **Мониторинг влажности**:
  * Пороговые значения:
    - Комфортный уровень: 40-60%
    - Предупреждение: 60-70%
    - Интенсивная вентиляция: более 70%
  * Защита от конденсации:
    - Автоматическое включение вентиляции при влажности выше 70%
    - Увеличение скорости вентиляторов при влажности выше 80%
  * Учет температуры:
    - Корректировка порогов влажности в зависимости от температуры
    - Предотвращение образования конденсата

- **Мониторинг PM2.5** (опционально):
  * Пороговые значения:
    - Нормальный уровень: до 25 µg/m³
    - Предупреждение: 25-50 µg/m³
    - Критический уровень: более 50 µg/m³
  * Защитные меры:
    - При уровне PM2.5 выше 50 µg/m³:
      * Отправка уведомления в Telegram
      * Рекомендация проветрить помещение естественным путем
    - При уровне PM2.5 выше 100 µg/m³:
      * Блокировка запуска вентиляции
      * Экстренное уведомление
      * Рекомендация проветрить помещение естественным путем
      * Рекомендация провести влажную уборку
  * Интеграция с уведомлениями:
    - Автоматические сообщения в Telegram
    - История измерений
    - Рекомендации по улучшению качества воздуха
  
- **Алгоритм управления**:
  * Плавное изменение скорости вентиляторов
  * Учет времени суток
  * Приоритет комфорта/энергосбережения
  * Комплексный анализ CO₂, влажности и PM2.5

#### 3. Специальные режимы работы
- **Ночной режим**:
  * Время активации: настраиваемое (по умолчанию 23:00 - 07:00) Ночной тариф
  * Снижение скорости вентиляторов до 30%
  * Пниженный порог CO₂ для включения вентиляции
  
- **Режим "Отсутствие"**:
  * Минимальная вентиляция
  * Поддержание базового воздухообмена
  * Защита от накопления влаги

#### 4. Система защиты от конфликтов
- Блокировка одновременной работы отопления и охлаждения
- Приоритеты режимов:
  1. Защита от обмерзания
  2. Контроль влажности
  3. Температурный комфорт
  4. Энергосбережение

### Установка и настройка

1. **Установка Home Assistant**:
   ```bash
   # Следуйте официальной инструкции на
   # https://www.home-assistant.io/installation/
   ```

2. **Установка интеграции Turkov**:
   - Добавьте репозиторий в HACS
   - Установите интеграцию
   - Перезагрузите Home Assistant

3. **Настройка AirGradient**:
   - Подключите датчик к сети WiFi
   - Настройте MQTT брокер
   - Добавьте сенсоры в Home Assistant

4. **Импорт Blueprint**:
   - Скопируйте файл `pvu_automation.yaml` в папку `blueprints/automation/`
   - Импортируйте через интерфейс Home Assistant

### Конфигурация

1. **Основные параметры** (`configuration.yaml`):
   ```yaml
   # Пример базовой конфигурации
   climate:
     - platform: turkov
       name: "PVU"
       modbus_host: 192.168.1.x
       modbus_port: 502

   sensor:
     - platform: mqtt
       name: "CO2 Level"
       state_topic: "airgradient/co2"
       unit_of_measurement: "ppm"
     - platform: mqtt
       name: "Humidity"
       state_topic: "airgradient/humidity"
       unit_of_measurement: "%"
     - platform: mqtt
       name: "PM2.5"
       state_topic: "airgradient/pm25"
       unit_of_measurement: "µg/m³"

   notify:
     - platform: telegram
       name: "Telegram Notifications"
       chat_id: "YOUR_CHAT_ID"
       default_message: "Уведомление от системы вентиляции"
   ```

2. **Автоматизации** (`automations.yaml`):
   ```yaml
   # Примеры будут добавлены позже
   ```

### Требования

1. **Аппаратные**:
   - Home Assistant с процессором ARM/x86
   - 2GB RAM минимум
   - Стабильное подключение к сети
   
2. **Программные**:
   - Home Assistant OS/Core
   - MQTT брокер
   - HACS

### Поддержка и обратная связь
- GitHub Issues: [создать обращение](https://github.com/your-repo/hass-PVU/issues)
- Telegram каналы:
  * [DIYIoT_Lab](https://t.me/DIYIoT_Lab) - Новости и обновления проекта
  * [DIYIoT_Zone](https://t.me/DIYIoT_Zone) - Сообщество разработчиков и энтузиастов

### Лицензия
MIT License
