# Changelog

## v0.3.1

- Для develop-версии `pvu.yaml` все `input sections` переведены в `collapsed: true` по умолчанию.
- Улучшен UX мастера настройки: форма открывается в компактном виде, секции разворачиваются по мере необходимости.

## v0.3.0

- Введено разделение blueprint на две ветки: `pvu_min.yaml` (стабильная база) и `pvu.yaml` (развиваемая версия).
- Добавлены метаданные blueprint: `author` и `homeassistant.min_version`.
- Усилен runtime fail-safe:
  - добавлена проверка доступности climate-сущности перед сервис-вызовами;
  - проверка поддерживаемых режимов переведена на нормализованное сравнение списков (без подстрочного `find`).
- Ускорена реакция автоматики: добавлены триггеры на опциональные IAQ-датчики и presence-источник.
- Добавлена политика на случай отсутствия наружной температуры (`outdoor_temp_policy`):
  - `conservative` (по умолчанию) блокирует `cooling/fan_only` при неизвестной `temp_outdoor`;
  - `permissive` сохраняет прежнее поведение.
- Добавлен `debug_mode` с диагностическими `persistent_notification` для трассировки решений автоматики.
- Обновлён `README.md`: добавлены варианты blueprint, quick start, актуальные примеры и описание новых настроек develop-ветки.

## v0.2.6

- Добавлен шаг `climate.set_temperature`: целевая уставка (`target_temp`) теперь применяется явно, а не только через смену HVAC/FAN режимов.
- Усилена логика присутствия для `presence_mode=alarm`: добавлен безопасный fallback для случаев, когда выбрана не `alarm_control_panel` сущность (например `group.*`).
- Полностью актуализирован `README.md`: документ синхронизирован с реальной логикой `pvu.yaml` и оформлен в формате, пригодном для публикации статьи.

## v0.2.5

- Исправлена критичная логика булевых вычислений в шаблонах (`is_away_bool`, `is_day_bool`), из-за которой могли неверно определяться режимы.
- Добавлена устойчивая проверка поддерживаемых режимов (`supported_hvac_modes` и `supported_fan_modes`) перед вызовами сервисов.
- Добавлена антизаморозочная защита для режима HVAC-вентиляции: новый порог `outdoor_vent_min`, ниже которого `fan_only` не включается.
- Исправлен импорт blueprint в Home Assistant: `off/maintain` в `select.options` зафиксированы как строковые значения.

## v0.2.4

- Зафиксирована конфигурация режимов под установку класса **Zenit Heco** с электрическим нагревателем и внешним охладителем: HVAC `off/fan_only/heat/cool`.
- Логика вентилятора переведена на 3 ступени (`low/medium/high`) с ограничением разгона при плохом наружном воздухе.
- В `input` для режимов добавлены `select`-поля с валидными значениями вместо свободного текста, чтобы исключить ошибочные команды.

## v0.2.1

- Проведена UI/UX-полировка `pvu.yaml`: поля в мастере Home Assistant сгруппированы по сценарию настройки (обязательные -> опциональные -> расписание -> пороги -> режимы).
- Улучшены названия и подсказки (`description`) для ключевых параметров, чтобы уменьшить вероятность ошибок при первичной настройке.
- Усилена защитная обработка опциональных сенсоров в шаблонах (`default`/безопасные строки) без изменения основной логики автоматики.
- Уточнены стартовые дефолты для более плавной работы: `outdoor_cool_min=18`, `co2_low=750`, `pm25_low=25`.
- Терминология приведена к AirGradient: используется **NOx Index** (а не абсолютный NO).

## v0.2.0

- Полностью переработан `pvu.yaml` с приоритетной логикой управления (влажность -> температура -> качество воздуха).
- Обязательными сделаны только внутренние датчики температуры и влажности; остальные датчики опциональны в любой комбинации.
- Добавлена поддержка внутренних и наружных CO2/PM2.5/VOC/NO, гистерезиса и ограничений boost при плохом наружном воздухе.
- Обновлена документация по MQTT-сценариям Turkov и требованиям к датчикам.
