# Roadmap hass-PVU

Это мой личный план развития проекта.

## Цели на 6 месяцев

- Довести develop-ветку до уровня `v1.0-ready` без потери стабильности.
- Сохранить `pvu_min.yaml` как консервативную стабильную базу.
- Снизить количество регрессий через регулярный release-процесс и базовую метрику качества.
- Упростить первый запуск: от импорта до рабочего сценария < 30 минут.

## Принцип веток

- `pvu_min.yaml` (stable): только bugfix/fail-safe/safety backport.
- `pvu.yaml` (develop): новые функции, UX, диагностика, экспериментальные опции.

Backport в stable делаем только после проверки в develop и smoke-теста по `docs/RELEASE_CHECKLIST.md`.

## Порядок работ: сначала low-hanging fruits

Ниже приоритет задан по принципу: сначала простые, безопасные и быстрые улучшения, потом средние, потом сложные.

## Этап 1 (быстрые и безопасные, 1-2 недели)

### Что делаю в первую очередь

- [x] Проверить и при необходимости backport `outdoor_temp_policy` в `pvu_min.yaml`.
- [x] Уточнить fallback при ограничениях `supported_*` режимов.
- [x] Добавить валидацию выбросов датчиков (нереалистичные значения).
- [x] Уточнить README по edge-cases и "что делать при unknown/unavailable".
- [x] Сформировать FAQ из повторяющихся вопросов в issues/TG.

### Ожидаемый результат

- Меньше регрессий без усложнения логики.
- Быстрые win-улучшения, которые сразу дают пользу пользователям.

## Этап 2 (средняя сложность, 2-6 недель)

### Технические улучшения

- [x] Добавить защиту от дрожания режимов (debounce/min interval) в develop.
- [x] Реализовать плавный возврат fan (`high -> medium -> low`) вместо резких переключений.
- [x] Расширить `debug_mode`: явная причина "почему режим не применён".

### HVAC-улучшения

- [x] Контроль частоты HVAC-переключений (износ/комфорт).
- [x] Проверка антизаморозки при неизвестной наружной температуре (`conservative`).
- [x] Верификация порогов CO2/PM2.5/VOC/NOx на реальных данных помещения.

## Этап 3 (более сложные фичи, 1-2 месяца)

- [x] Профили настроек: `climate_profile` (континентальный/мягкий/холодный).
- [x] Профили жилья: `apartment/house/office`.
- [x] Сезонный smoke-test и типовые сценарии "зима/межсезонье/лето" как регулярная практика.

## Release train

| Версия | Фокус | Статус |
| --- | --- | --- |
| `v0.3.4` | Low-hanging fruits | ✅ Выпущено |
| `v0.4.0` | Стабильность переключений + диагностика | ✅ Выпущено |
| `v0.5.0` | Профили/пресеты, сезонные сценарии | ✅ Выпущено |
| `v0.6.0` | ECO режим, политики away, coupling protection | ✅ Выпущено |
| `v0.7.0` | Архитектурный рефакторинг HVAC-логики (ПВУ ≠ термостат) | ✅ Выпущено |
| `v0.7.2` | Исправления: ECO/fan coupling, fan_stepdown, антизаморозка | ✅ Выпущено |
| `v0.7.3` | Исправления: VOC/NOx plausibility, presence_mode=custom, alarm UI | ✅ Выпущено |
| `v0.7.4` | Исправления: outdoor plausibility >= 0, humidity plausibility >= 0 | ✅ Выпущено |
| `v1.0.0` | Стабильный релиз | ⏳ Цель |

## Метрики и наблюдение (без отдельной инфраструктуры)

### KPI

- [ ] Доля времени в температурной зоне комфорта.
- [ ] Доля времени CO2 ниже порога.
- [ ] Частота переключений HVAC в час.
- [ ] Доля времени fan в `low`.
- [ ] Количество защитных срабатываний (`outdoor_temp_policy`, anti-freeze fallback).

### Как собирать

- Recorder + History Stats + template-сенсоры.
- Еженедельный обзор KPI на Lovelace.
- Сравнения `pvu_min.yaml` vs `pvu.yaml` по одинаковым входным условиям.

## Документация и коммуникации

- [x] Обновлять `README.md` при каждом изменении поведения.
- [x] К каждому релизу: `CHANGELOG.md` + короткий TG-анонс (`docs/TG_POST_RU.md`).
- [x] Поддерживать `docs/ARTICLE_RU.md` в актуальном состоянии как "длинную" версию.
- [x] Собрать FAQ из повторяющихся вопросов в issues/TG.

## Критерии готовности `v1.0`

- [ ] Нет открытых критичных багов.
- [ ] Полностью пройден `docs/RELEASE_CHECKLIST.md`.
- [ ] Проверены оба blueprint: `pvu_min.yaml` и `pvu.yaml`.
- [ ] Есть подтверждение стабильной работы минимум от 3 независимых пользователей.
- [ ] Документация синхронизирована с фактической логикой кода.
