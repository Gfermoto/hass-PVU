# FAQ

## Зачем два файла: `pvu_min.yaml` и `pvu.yaml`?

- `pvu_min.yaml` — стабильная база с минимальным риском изменений.
- `pvu.yaml` — развиваемая версия с новыми возможностями и UX-улучшениями.

## Что делать, если `climate` становится `unavailable`?

Автоматизация не отправляет сервисные команды, пока `climate` недоступна.  
Проверьте интеграцию Turkov/сеть и состояние сущности в Home Assistant.

## Что делать, если датчик показывает странные значения?

В логике добавлена фильтрация нереалистичных значений (выбросов).  
Если значение выходит за допустимый диапазон, оно не участвует в принятии решений.

## Почему не включается `fan_only` или `cool` при отсутствии наружного датчика?

Проверьте `outdoor_temp_policy`:

- `conservative` (по умолчанию) — блокирует `fan_only`/`cool`, если `temp_outdoor` неизвестна.
- `permissive` — разрешает поведение без ограничения по наружной температуре.

## Почему режим не переключается, хотя рассчитан новый?

Автоматизация применяет режим только если:

- режим не пустой;
- режим отличается от текущего;
- режим поддерживается устройством (`supported_hvac_modes`/`supported_fan_modes`).

Если режим не поддерживается, сохраняется текущий (без принудительного переключения).

## Как понять, что именно решила автоматика?

В `pvu.yaml` включите `debug_mode`: появятся `persistent_notification` с ключевыми флагами и причинами ограничений.

## Как проверить и подстроить пороги CO2/PM2.5/VOC/NOx на реальных данных?

Используйте пошаговый гайд: [`docs/TUNING.md`](./TUNING.md).

Коротко:

- соберите 3-7 дней истории;
- меняйте пороги небольшими шагами;
- после каждого изменения наблюдайте минимум 24 часа;
- фиксируйте, стало ли меньше ложных разгонов без потери комфорта.

## Почему в Lovelace появляется ошибка `No card type configured`?

Обычно это происходит, когда YAML целого дашборда вставляют в редактор одной карточки.

Используйте правильно:

- для **целого дашборда**: `airflow_dashboard.yaml` или `airflow_dashboard_min.yaml` (через "Редактировать в YAML");
- для **Manual card**: `airflow_dashboard_card.yaml` или `airflow_dashboard_min_card.yaml`.

## Как закрыть верификацию порогов не "на глаз", а по метрикам?

Подключите пакет [`airflow_kpi_package.yaml`](../airflow_kpi_package.yaml), после чего отслеживайте:

- `sensor.airflow_co2_ok_percent_24h`
- `sensor.airflow_pm25_ok_percent_24h`
- `sensor.airflow_voc_ok_percent_24h`
- `sensor.airflow_nox_ok_percent_24h`
- `sensor.airflow_boost_fan_percent_24h`

Эти показатели дают объективную картину по суткам и позволяют корректно завершить этап верификации.

## Какой минимальный набор для старта?

- `climate` сущность Turkov;
- `temp_indoor`;
- `humidity_indoor`.

Остальные датчики можно подключать постепенно.
